// nextflow.config

conda.enabled = true

// process READ parameters 
params.read_in = "input/filtered_gene_bc_matrices/hg19/"
params.read_out = "adata.h5ad"

// process PREPRO parameters
params.pre_in = "output/adata.h5ad"
params.pre_out = "figures/highest_expr_genes_2.png"
params.vio1 = "figures/violin_n_genes_by_counts_2.png"
params.vio2 = "figures/violin_total_counts_2.png"
params.vio3 = "figures/violin_pct_counts_mt_2.png"
params.scat1 = "figures/scatter_pct_counts_mt_2.png"
params.scat2 = "figures/scatter_n_genes_by_counts_2.png"
params.dispersion = "figures/filter_genes_dispersion_scatter_2.png"
params.pre_adata_out = "adata_2pp_out.h5ad"

// process PCA parameters 
params.pca_in = "output/adata_2pp_out.h5ad"
params.pca_plot1 = "figures/pca_scatter_3.png" 
params.pca_plot2 = "figures/pca_variance_ratio_3.png"
params.pca_plot3 = "figures/umap_raw_embedding_neighbourhood_3.png"
params.pca_plot4 = "figures/umap_embedding_neighbourhood_3.png"
params.pca_plot5 = "figures/umap_leiden_graph_clustering_3.png"
params.pca_out = "pbmc3k.h5ad"

// process M_GENES parameters 
params.mgenes_in = "output/pbmc3k.h5ad"
params.text_in = "input/marker_genes.csv"
params.mgenes_plot1 = "figures/rank_genes_groups_leiden_4.png"
params.mgenes_plot2 = "figures/rank_genes_groups_leiden_wilcoxon_4.png"
params.mgenes_out = "pbmc3k_4.h5ad"
params.mgenes_plot3 = "figures/rank_genes_groups_leiden_logistic_regression_4.png"
params.mgenes_plot4 = "figures/rank_genes_groups_leiden_single_cluster_4.png"
params.mgenes_plot5 = "figures/rank_genes_groups_leiden_0_violin_4.png"
params.mgenes_plot6 = "figures/rank_genes_groups_leiden_0_violin_differential_expression_4.png"
params.mgenes_plot7 = "figures/violin_compare_across_groups_4.png"
params.mgenes_plot8 = "figures/umap_leiden_cell_types_4.pdf"
params.mgenes_plot9 = "figures/dotplot_leiden_marker_genes_4.png"
params.mgenes_plot10 = "figures/stacked_violin_leiden_marker_genes_4.png"
params.mgenes_out2 = "pbmc3k_4_end.h5ad"
params.mgenes_out3 = "pbmc3k_withoutX.h5ad"

// process GENERATE_HTML parameters
params.html_in = "jinja/html_csv_test.csv"
params.template_html = "sc-analysis-nf/jinja/templates/index.html"
params.html_out = "output/index.html"

// process SOUP parameters
params.soup_in = "/Users/nlg143/projects/sc-analysis-nf/input/FCAImmP7241240/output/Gene/filtered/ "
params.soup_raw_in = "/Users/nlg143/projects/sc-analysis-nf/input/FCAImmP7241240/output/Gene/raw/"
params.soup_barcodes_out = "/Users/nlg143/projects/sc-analysis-nf/output/FCAImmP7241240soupX_filt/barcodes.tsv"
params.soup_genes_out = "/Users/nlg143/projects/sc-analysis-nf/output/FCAImmP7241240soupX_filt/genes.tsv"
params.soup_matrix_out = "output/FCAImmP7241240soupX_filt/matrix.mtx"
params.soup_plot = "figures/soup.channel.png"

// process LOAD_DATA parameters
params.load_in = "/Users/nlg143/projects/sc-analysis-nf/output/FCAImmP7241240soupX_filt/matrix.mtx"
//params.metadata = "dont/have/file/yet"
params.load_raw_out = "Fskin_0.1.1_raw"
//params.load_meta_out = ""

// yaml file used to make the conda environment needed for 'READ|PREPRO|PCA|M_GENES'
process {
    withName: 'READ|PREPRO|PCA|M_GENES|GENERATE_HTML' {
        conda = "$projectDir/envs/environment.yaml"
    }
}
process {
    withName: 'SOUP|LOAD_DATA' {
        conda = "$projectDir/envs/cellrank.yaml"
    }
}